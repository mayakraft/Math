!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(n="undefined"!=typeof globalThis?globalThis:n||self).math=t()}(this,(function(){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(t)}function t(n,t){return function(n){if(Array.isArray(n))return n}(n)||function(n,t){var r=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null==r)return;var i,e,o=[],u=!0,c=!1;try{for(r=r.call(n);!(u=(i=r.next()).done)&&(o.push(i.value),!t||o.length!==t);u=!0);}catch(n){c=!0,e=n}finally{try{u||null==r.return||r.return()}finally{if(c)throw e}}return o}(n,t)||i(n,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(n){return function(n){if(Array.isArray(n))return e(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||i(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(n,t){if(n){if("string"==typeof n)return e(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);return"Object"===r&&n.constructor&&(r=n.constructor.name),"Map"===r||"Set"===r?Array.from(n):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(n,t):void 0}}function e(n,t){(null==t||t>n.length)&&(t=n.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=n[r];return i}var o=function(t){switch(t.constructor.name){case"vector":case"matrix":case"segment":case"ray":case"line":case"circle":case"ellipse":case"rect":case"polygon":return t.constructor.name}if("object"===n(t)){if(null!=t.radius)return"circle";if(null!=t.width)return"rect";if(null!=t.x||"number"==typeof t[0])return"vector";if(null!=t[0]&&t[0].length&&("number"==typeof t[0].x||"number"==typeof t[0][0]))return"segment";if(null!=t.vector&&null!=t.origin)return"line"}},u=function(n,t){return t.length===n?t:Array(n).fill(0).map((function(n,r){return t[r]?t[r]:n}))},c=function(n,t){var r=n.length>t.length?n.length:t.length;return[n,t].map((function(n){return u(r,n)}))},a=function(n){var t="".concat(n).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0},f=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;if("number"!=typeof n)return n;var r=parseFloat(n.toFixed(t));return a(r)===Math.min(t,a(n))?n:r},s=function(n){return null!=n&&"function"==typeof n[Symbol.iterator]},l=function n(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return s(arguments[0])&&"string"!=typeof arguments[0]?n.apply(void 0,r(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(t){return s(t)?r(n(t)):t}))}},h=function n(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return s(arguments[0])&&"string"!=typeof arguments[0]?n.apply(void 0,r(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(t){return s(t)?r(n(t)):t})).reduce((function(n,t){return n.concat(t)}),[])}},p=Object.freeze({__proto__:null,resize:u,resizeUp:c,resizeDown:function(n,t){var r=n.length>t.length?t.length:n.length;return[n,t].map((function(n){return u(r,n)}))},cleanNumber:f,semiFlattenArrays:l,flattenArrays:h}),v=1e-6,g=180/Math.PI,d=Math.PI/180,y=2*Math.PI,m=Object.freeze({__proto__:null,EPSILON:v,R2D:g,D2R:d,TWO_PI:y}),M=function(){return!0},b=function(n){return n*n},x=function(n,t){return n+(t||0)},_=function(n){return void 0!==n},P=function(n){return Math.atan2(n[1],n[0])},A=function(n){return[Math.cos(n),Math.sin(n)]},w=function(n,t){return Math.abs(n-t)<v},j=function(n,t){for(var r=0;r<Math.max(n.length,t.length);r++)if(!w(n[r]||0,t[r]||0))return!1;return!0},O=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v;return n>-t},k=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v;return n>t},S=M,I=M,C=O,z=k,L=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v;return n>-t&&n<1+t},E=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v;return n>t&&n<1-t},q=function(n){return n<-v?0:n},R=function(n){return n<-v?0:n>1.000001?1:n},N=Object.freeze({__proto__:null,fnTrue:M,fnSquare:b,fnAdd:x,fnNotUndefined:_,fnAnd:function(n,t){return n&&t},fnCat:function(n,t){return n.concat(t)},fnVec2Angle:P,fnToVec2:A,fnEqual:function(n,t){return n===t},fnEpsilonEqual:w,fnEpsilonEqualVectors:j,include:O,exclude:k,includeL:S,excludeL:I,includeR:C,excludeR:z,includeS:L,excludeS:E,lineLimiter:function(n){return n},rayLimiter:q,segmentLimiter:R}),G=Object.create(null),T=[1,0,0,1],V=T.concat(0,0),B=function(n){return n[0]*n[3]-n[1]*n[2]},F=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],r=Math.cos(n),i=Math.sin(n);return[r,i,-i,r,t[0],t[1]]},D=Object.freeze({__proto__:null,identity2x2:T,identity2x3:V,multiplyMatrix2Vector2:function(n,t){return[n[0]*t[0]+n[2]*t[1]+n[4],n[1]*t[0]+n[3]*t[1]+n[5]]},multiplyMatrix2Line2:function(n,t,r){return{vector:[n[0]*t[0]+n[2]*t[1],n[1]*t[0]+n[3]*t[1]],origin:[n[0]*r[0]+n[2]*r[1]+n[4],n[1]*r[0]+n[3]*r[1]+n[5]]}},multiplyMatrices2:function(n,t){return[n[0]*t[0]+n[2]*t[1],n[1]*t[0]+n[3]*t[1],n[0]*t[2]+n[2]*t[3],n[1]*t[2]+n[3]*t[3],n[0]*t[4]+n[2]*t[5]+n[4],n[1]*t[4]+n[3]*t[5]+n[5]]},determinant2:B,invertMatrix2:function(n){var t=B(n);if(!(Math.abs(t)<1e-6||isNaN(t))&&isFinite(n[4])&&isFinite(n[5]))return[n[3]/t,-n[1]/t,-n[2]/t,n[0]/t,(n[2]*n[5]-n[3]*n[4])/t,(n[1]*n[4]-n[0]*n[5])/t]},makeMatrix2Translate:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return T.concat(n,t)},makeMatrix2Scale:function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0];return[n,0,0,t,n*-r[0]+r[0],t*-r[1]+r[1]]},makeMatrix2Rotate:F,makeMatrix2Reflect:function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],r=Math.atan2(n[1],n[0]),i=Math.cos(r),e=Math.sin(r),o=Math.cos(-r),u=Math.sin(-r),c=i*o+e*u,a=i*-u+e*o,f=e*o+-i*u,s=e*-u+-i*o,l=t[0]+c*-t[0]+-t[1]*f,h=t[1]+a*-t[0]+-t[1]*s;return[c,a,f,s,l,h]}}),Z=function(n){return Math.sqrt(n.map(b).reduce(x,0))},U=function(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])},H=function(n){return n.map(b).reduce(x,0)},X=function(n){var t=Z(n);return 0===t?n:n.map((function(n){return n/t}))},Y=function(n,t){return n.map((function(n){return n*t}))},$=function(n,t){return[n[0]*t,n[1]*t]},W=function(n,t){return n.map((function(n,r){return n+(t[r]||0)}))},J=function(n,t){return[n[0]+t[0],n[1]+t[1]]},K=function(n,t){return n.map((function(n,r){return n-(t[r]||0)}))},Q=function(n,t){return n.map((function(r,i){return n[i]*t[i]})).reduce(x,0)},nn=function(n,t){return n.map((function(n,r){return(n+t[r])/2}))},tn=function(){var n=arguments;if(0===arguments.length)return[];var t=arguments[0].length>0?arguments[0].length:0,r=Array(t).fill(0);return Array.from(arguments).forEach((function(n){return r.forEach((function(t,i){r[i]+=n[i]||0}))})),r.map((function(t){return t/n.length}))},rn=function(n,t,r){var i=1-r;return n.map((function(n,e){return n*i+(t[e]||0)*r}))},en=function(n,t){return n[0]*t[1]-n[1]*t[0]},on=function(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]},un=function(n,t){return Math.sqrt(n.map((function(r,i){return Math.pow(n[i]-t[i],2)})).reduce(x,0))},cn=function(n,t){var r=n[0]-t[0],i=n[1]-t[1];return Math.sqrt(r*r+i*i)},an=function(n){return n.map((function(n){return-n}))},fn=function(n){return[-n[1],n[0]]},sn=function(n){return[n[1],-n[0]]},ln=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v;return n.map((function(n){return Math.abs(n)})).reduce(x,0)<t},hn=function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v;return 1-Math.abs(Q(X(n),X(t)))<r},pn=Object.freeze({__proto__:null,magnitude:Z,magnitude2:U,magSquared:H,normalize:X,normalize2:function(n){var t=U(n);return 0===t?n:[n[0]/t,n[1]/t]},scale:Y,scale2:$,add:W,add2:J,subtract:K,subtract2:function(n,t){return[n[0]-t[0],n[1]-t[1]]},dot:Q,dot2:function(n,t){return n[0]*t[0]+n[1]*t[1]},midpoint:nn,midpoint2:function(n,t){return $(J(n,t),.5)},average:tn,lerp:rn,cross2:en,cross3:on,distance:un,distance2:cn,distance3:function(n,t){var r=n[0]-t[0],i=n[1]-t[1],e=n[2]-t[2];return Math.sqrt(r*r+i*i+e*e)},flip:an,rotate90:fn,rotate270:sn,degenerate:ln,parallel:hn,parallel2:function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v;return Math.abs(en(n,t))<r}}),vn=Object.freeze([1,0,0,0,1,0,0,0,1]),gn=Object.freeze(vn.concat(0,0,0)),dn=function(n){return gn.map((function(t,r){return Math.abs(t-n[r])<v})).reduce((function(n,t){return n&&t}),!0)},yn=function(n,t){return[n[0]*t[0]+n[3]*t[1]+n[6]*t[2]+n[9],n[1]*t[0]+n[4]*t[1]+n[7]*t[2]+n[10],n[2]*t[0]+n[5]*t[1]+n[8]*t[2]+n[11]]},mn=function(n,t,r){return{vector:[n[0]*t[0]+n[3]*t[1]+n[6]*t[2],n[1]*t[0]+n[4]*t[1]+n[7]*t[2],n[2]*t[0]+n[5]*t[1]+n[8]*t[2]],origin:[n[0]*r[0]+n[3]*r[1]+n[6]*r[2]+n[9],n[1]*r[0]+n[4]*r[1]+n[7]*r[2]+n[10],n[2]*r[0]+n[5]*r[1]+n[8]*r[2]+n[11]]}},Mn=function(n,t){return[n[0]*t[0]+n[3]*t[1]+n[6]*t[2],n[1]*t[0]+n[4]*t[1]+n[7]*t[2],n[2]*t[0]+n[5]*t[1]+n[8]*t[2],n[0]*t[3]+n[3]*t[4]+n[6]*t[5],n[1]*t[3]+n[4]*t[4]+n[7]*t[5],n[2]*t[3]+n[5]*t[4]+n[8]*t[5],n[0]*t[6]+n[3]*t[7]+n[6]*t[8],n[1]*t[6]+n[4]*t[7]+n[7]*t[8],n[2]*t[6]+n[5]*t[7]+n[8]*t[8],n[0]*t[9]+n[3]*t[10]+n[6]*t[11]+n[9],n[1]*t[9]+n[4]*t[10]+n[7]*t[11]+n[10],n[2]*t[9]+n[5]*t[10]+n[8]*t[11]+n[11]]},bn=function(n){return n[0]*n[4]*n[8]-n[0]*n[7]*n[5]-n[3]*n[1]*n[8]+n[3]*n[7]*n[2]+n[6]*n[1]*n[5]-n[6]*n[4]*n[2]},xn=function(n){var t=bn(n);if(!(Math.abs(t)<1e-6||isNaN(t))&&isFinite(n[9])&&isFinite(n[10])&&isFinite(n[11])){var r=[n[4]*n[8]-n[7]*n[5],-n[1]*n[8]+n[7]*n[2],n[1]*n[5]-n[4]*n[2],-n[3]*n[8]+n[6]*n[5],n[0]*n[8]-n[6]*n[2],-n[0]*n[5]+n[3]*n[2],n[3]*n[7]-n[6]*n[4],-n[0]*n[7]+n[6]*n[1],n[0]*n[4]-n[3]*n[1],-n[3]*n[7]*n[11]+n[3]*n[8]*n[10]+n[6]*n[4]*n[11]-n[6]*n[5]*n[10]-n[9]*n[4]*n[8]+n[9]*n[5]*n[7],n[0]*n[7]*n[11]-n[0]*n[8]*n[10]-n[6]*n[1]*n[11]+n[6]*n[2]*n[10]+n[9]*n[1]*n[8]-n[9]*n[2]*n[7],-n[0]*n[4]*n[11]+n[0]*n[5]*n[10]+n[3]*n[1]*n[11]-n[3]*n[2]*n[10]-n[9]*n[1]*n[5]+n[9]*n[2]*n[4]],i=1/t;return r.map((function(n){return n*i}))}},_n=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return vn.concat(n,t,r)},Pn=function(n,t,r,i,e){var o=vn.concat([0,1,2].map((function(n){return t[n]||0}))),u=Math.cos(n),c=Math.sin(n);return o[3*r+r]=u,o[3*r+i]=(e?1:-1)*c,o[3*i+r]=(e?-1:1)*c,o[3*i+i]=u,o},An=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return Pn(n,t,1,2,!0)},wn=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return Pn(n,t,0,2,!1)},jn=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return Pn(n,t,0,1,!0)},On=function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0],e=[0,1,2].map((function(n){return i[n]||0})),o=u(3,X(r)),c=t(o,3),a=c[0],f=c[1],s=c[2],l=Math.cos(n),h=Math.sin(n),p=1-l,v=vn.concat(-e[0],-e[1],-e[2]),g=vn.concat(e[0],e[1],e[2]);return Mn(g,Mn([p*a*a+l,p*f*a+s*h,p*s*a-f*h,p*a*f-s*h,p*f*f+l,p*s*f+a*h,p*a*s+f*h,p*f*s-a*h,p*s*s+l,0,0,0],v))},kn=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return[n,0,0,0,n,0,0,0,n,n*-t[0]+t[0],n*-t[1]+t[1],n*-t[2]+t[2]]},Sn=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],r=Math.atan2(n[1],n[0]),i=Math.cos(r),e=Math.sin(r),o=Math.cos(-r),u=Math.sin(-r),c=i*o+e*u,a=i*-u+e*o,f=e*o+-i*u,s=e*-u+-i*o,l=t[0]+c*-t[0]+-t[1]*f,h=t[1]+a*-t[0]+-t[1]*s;return[c,a,0,f,s,0,0,0,1,l,h,0]},In=Object.freeze({__proto__:null,identity3x3:vn,identity3x4:gn,isIdentity3x4:dn,multiplyMatrix3Vector3:yn,multiplyMatrix3Line3:mn,multiplyMatrices3:Mn,determinant3:bn,invertMatrix3:xn,makeMatrix3Translate:_n,makeMatrix3RotateX:An,makeMatrix3RotateY:wn,makeMatrix3RotateZ:jn,makeMatrix3Rotate:On,makeMatrix3Scale:kn,makeMatrix3ReflectZ:Sn}),Cn=function(n,t){return{vector:n||[],origin:t||[]}},zn=function(){if(arguments[0]instanceof G.vector)return arguments[0];var t=h(arguments);return t.length>0&&"object"===n(t[0])&&null!==t[0]&&!isNaN(t[0].x)&&(t=["x","y","z"].map((function(n){return t[0][n]})).filter(_)),t.filter((function(n){return"number"==typeof n}))},Ln=function(){return l(arguments).map((function(n){return zn(n)}))},En=function(){if(arguments[0]instanceof G.segment)return arguments[0];var n=l(arguments);return 4===n.length?[[n[0],n[1]],[n[2],n[3]]]:n.map((function(n){return zn(n)}))},qn=function(){var n=l(arguments);return 0===n.length?Cn([],[]):n[0]instanceof G.line||n[0]instanceof G.ray||n[0]instanceof G.segment?n[0]:n[0].constructor===Object&&void 0!==n[0].vector?Cn(n[0].vector||[],n[0].origin||[]):"number"==typeof n[0]?Cn(zn(n)):Cn.apply(void 0,r(n.map((function(n){return zn(n)}))))},Rn=qn,Nn=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return{x:n,y:t,width:r,height:i}},Gn=function(){if(arguments[0]instanceof G.rect)return arguments[0];var t=h(arguments);if(t.length>0&&"object"===n(t[0])&&null!==t[0]&&!isNaN(t[0].width))return Nn.apply(void 0,r(["x","y","width","height"].map((function(n){return t[0][n]})).filter(_)));var i=t.filter((function(n){return"number"==typeof n})),e=i.length<4?[,,].concat(r(i)):i;return Nn.apply(void 0,r(e))},Tn=function(){for(var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return{radius:n,origin:[].concat(r)}},Vn=function(){if(arguments[0]instanceof G.circle)return arguments[0];var n=Ln(arguments),t=h(arguments).filter((function(n){return"number"==typeof n}));if(2===arguments.length){if(1===n[1].length)return Tn.apply(void 0,[n[1][0]].concat(r(n[0])));if(1===n[0].length)return Tn.apply(void 0,[n[0][0]].concat(r(n[1])));if(n[0].length>1&&n[1].length>1)return Tn.apply(void 0,[cn.apply(void 0,r(n))].concat(r(n[0])))}else switch(t.length){case 0:return Tn(1,0,0,0);case 1:return Tn(t[0],0,0,0);default:return Tn.apply(void 0,[t.pop()].concat(r(t)))}return Tn(1,0,0,0)},Bn=[[0,1,3,4,9,10],[0,1,2,3,4,5,6,7,8,9,10,11],[0,1,2,void 0,3,4,5,void 0,6,7,8,void 0,9,10,11]];[11,7,3].forEach((function(n){return delete Bn[2][n]}));var Fn=function(n){return Bn[n<8?0:n<13?1:2]},Dn=function(){var n=h(arguments),t=r(gn);return Fn(n.length).forEach((function(r,i){null!=n[i]&&(t[r]=n[i])})),t},Zn=Object.freeze({__proto__:null,getVector:zn,getVectorOfVectors:Ln,getSegment:En,getLine:qn,getRay:Rn,getRectParams:Nn,getRect:Gn,getCircle:Vn,getMatrix3x4:Dn}),Un=Object.freeze({__proto__:null}),Hn=Object.freeze({__proto__:null,sortPointsAlongVector2:function(n,t){return n.map((function(n){return{point:n,d:n[0]*t[0]+n[1]*t[1]}})).sort((function(n,t){return n.d-t.d})).map((function(n){return n.point}))}}),Xn=function(n,t,r){for(var i,e=t.map((function(t,i){return{o:t,i:i,d:r(n,t)}})),o=1/0,u=0;u<e.length;u+=1)e[u].d<o&&(i=u,o=e[u].d);return i},Yn=function(n,t,r,i){var e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:v;t=u(n.length,t),r=u(n.length,r);var o=H(n),c=K(r,t),a=Q(n,c),f=a/o,s=i(f,e);return W(t,Y(n,s))},$n=function(n,t){var r=n.map((function(n,t,r){return K(r[(t+1)%r.length],n)}));return n.map((function(n,i){return Yn(r[i],n,t,R)})).map((function(n,r){return{point:n,i:r,distance:un(n,t)}})).sort((function(n,t){return n.distance-t.distance})).shift()},Wn=function(n,t,r){return W(t,Y(X(K(r,t)),n))},Jn=Object.freeze({__proto__:null,smallestComparisonSearch:Xn,nearestPoint2:function(n,t){var r=Xn(n,t,cn);return void 0===r?void 0:t[r]},nearestPoint:function(n,t){var r=Xn(n,t,un);return void 0===r?void 0:t[r]},nearestPointOnLine:Yn,nearestPointOnPolygon:$n,nearestPointOnCircle:Wn}),Kn=function(n,t){for(;n<0;)n+=y;for(;t<0;)t+=y;for(;n>y;)n-=y;for(;t>y;)t-=y;var r=n-t;return r>=0?r:y-(t-n)},Qn=function(n,t){for(;n<0;)n+=y;for(;t<0;)t+=y;for(;n>y;)n-=y;for(;t>y;)t-=y;var r=t-n;return r>=0?r:y-(n-t)},nt=function(n,t){var r=t[0]*n[0]+t[1]*n[1],i=t[0]*n[1]-t[1]*n[0],e=Math.atan2(i,r);return e<0&&(e+=y),e},tt=function(n,t){var r=n[0]*t[0]+n[1]*t[1],i=n[0]*t[1]-n[1]*t[0],e=Math.atan2(i,r);return e<0&&(e+=y),e},rt=function(n,t){return A(P(n)-nt(n,t)/2)},it=function(n,t){return A(P(n)+tt(n,t)/2)},et=function(n,t,r){var i=Kn(t,r)/n;return Array.from(Array(n-1)).map((function(n,r){return t+i*(r+1)}))},ot=function(n,t,r){var i=Qn(t,r)/n;return Array.from(Array(n-1)).map((function(n,r){return t+i*(r+1)}))},ut=function(n,t,r){var i=Math.atan2(t[1],t[0]),e=Math.atan2(r[1],r[0]);return et(n,i,e).map(A)},ct=function(n,t,r){var i=Math.atan2(t[1],t[0]),e=Math.atan2(r[1],r[0]);return ot(n,i,e).map(A)},at=function(n,t,i,e){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:v,u=en(n,i),c=Q(n,i),a=u>-o?[it(n,i)]:[rt(n,i)];a[1]=u>-o?fn(a[0]):sn(a[0]);var f=(e[0]-t[0])*i[1]-i[0]*(e[1]-t[1]),s=f/u,l=[n,i].map((function(n){return X(n)})),h=Math.abs(en.apply(void 0,r(l)))<o,p=h?nn(t,e):[t[0]+n[0]*s,t[1]+n[1]*s],g=a.map((function(n){return{vector:n,origin:p}}));return h&&delete g[c>-o?1:0],g},ft=function(){var n=Array.from(arguments).flat(),t=n.map((function(n,t){return t})).sort((function(t,r){return n[t]-n[r]}));return t.slice(t.indexOf(0),t.length).concat(t.slice(0,t.indexOf(0)))},st=function(){var n=Array.from(arguments).flat(),t=ft(n).map((function(t){return n[t]}));return t.map((function(n,t,r){return[n,r[(t+1)%r.length]]})).map((function(n){return Qn(n[0],n[1])}))},lt=Object.freeze({__proto__:null,isCounterClockwiseBetween:function(n,t,r){for(;r<t;)r+=y;for(;n>t;)n-=y;for(;n<t;)n+=y;return n<r},clockwiseAngleRadians:Kn,counterClockwiseAngleRadians:Qn,clockwiseAngle2:nt,counterClockwiseAngle2:tt,clockwiseBisect2:rt,counterClockwiseBisect2:it,clockwiseSubsectRadians:et,counterClockwiseSubsectRadians:ot,clockwiseSubsect2:ut,counterClockwiseSubsect2:ct,bisectLines2:at,counterClockwiseOrderRadians:ft,counterClockwiseOrder2:function(){return ft(l(arguments).map(P))},counterClockwiseSectorsRadians:st,counterClockwiseSectors2:function(){return st(Ln(arguments).map(P))}}),ht=function(n,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:I,e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:v,o=K(r,t),u=H(n),c=Math.sqrt(u);if(c<e)return!1;var a=en(o,n.map((function(n){return n/c}))),f=Q(o,n)/u;return Math.abs(a)<e&&i(f,e/c)},pt=function(n,t,r,i){var e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:S,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:S,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:v,c=en(X(n),X(r));if(!(Math.abs(c)<u)){var a=en(n,r),f=-a,s=[i[0]-t[0],i[1]-t[1]],l=[-s[0],-s[1]],h=en(s,r)/a,p=en(l,n)/f;return e(h,u/Z(n))&&o(p,u/Z(r))?W(t,Y(n,h)):void 0}},vt=function(n,t,r){var i=t[0]-n[0],e=t[1]-n[1],o=r[0]-n[0],u=r[1]-n[1],c=i*(n[0]+t[0])+e*(n[1]+t[1]),a=o*(n[0]+r[0])+u*(n[1]+r[1]),f=2*(i*(r[1]-t[1])-e*(r[0]-t[0]));if(Math.abs(f)<v){var s=Math.min(n[0],t[0],r[0]),l=Math.min(n[1],t[1],r[1]),h=.5*(Math.max(n[0],t[0],r[0])-s),p=.5*(Math.max(n[1],t[1],r[1])-l);return{origin:[s+h,l+p],radius:Math.sqrt(h*h+p*p)}}var g=[(u*c-e*a)/f,(i*a-o*c)/f],d=g[0]-n[0],y=g[1]-n[1];return{origin:g,radius:Math.sqrt(d*d+y*y)}},gt=function(n){return.5*n.map((function(n,t,r){var i=r[(t+1)%r.length];return n[0]*i[1]-i[0]*n[1]})).reduce(x,0)},dt=function(n){var t=1/(6*gt(n));return n.map((function(n,t,r){var i=r[(t+1)%r.length],e=n[0]*i[1]-i[0]*n[1];return[(n[0]+i[0])*e,(n[1]+i[1])*e]})).reduce((function(n,t){return[n[0]+t[0],n[1]+t[1]]}),[0,0]).map((function(n){return n*t}))},yt=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=Array(n[0].length).fill(1/0),i=Array(n[0].length).fill(-1/0);n.forEach((function(n){return n.forEach((function(n,e){n<r[e]&&(r[e]=n-t),n>i[e]&&(i[e]=n+t)}))}));var e=i.map((function(n,t){return n-r[t]}));return{min:r,max:i,span:e}},mt=function(n){return Array.from(Array(Math.floor(n))).map((function(t,r){return y*(r/n)}))},Mt=function(n,t){return n.map((function(n){return[t*Math.cos(n),t*Math.sin(n)]})).map((function(n){return n.map((function(n){return f(n,14)}))}))},bt=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Mt(mt(n),t)},xt=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=Math.PI/n,i=mt(n).map((function(n){return n+r}));return Mt(i,t)},_t=function(n,t,r){var i=n.map((function(n,i){return{point:ht(t,r,n,S)?n:null,at_index:i}})).filter((function(n){return null!=n.point})),e=n.map((function(n,i,e){return{point:pt(t,r,K(n,e[(i+1)%e.length]),e[(i+1)%e.length],I,E),at_index:i}})).filter((function(n){return null!=n.point}));if(2==e.length){var o=e.slice().sort((function(n,t){return n.at_index-t.at_index})),u=n.slice(o[1].at_index+1).concat(n.slice(0,o[0].at_index+1));u.push(o[0].point),u.push(o[1].point);var c=n.slice(o[0].at_index+1,o[1].at_index+1);return c.push(o[1].point),c.push(o[0].point),[u,c]}if(1==e.length&&1==i.length){i[0].type="v",e[0].type="e";var a=i.concat(e).sort((function(n,t){return n.at_index-t.at_index})),f=n.slice(a[1].at_index+1).concat(n.slice(0,a[0].at_index+1));"e"===a[0].type&&f.push(a[0].point),f.push(a[1].point);var s=n.slice(a[0].at_index+1,a[1].at_index+1);return"e"===a[1].type&&s.push(a[1].point),s.push(a[0].point),[f,s]}if(2==i.length){var l=i.slice().sort((function(n,t){return n.at_index-t.at_index}));return[n.slice(l[1].at_index).concat(n.slice(0,l[0].at_index+1)),n.slice(l[0].at_index,l[1].at_index+1)]}return[n.slice()]},Pt=function(t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v,i=1e4,e=t.slice().sort((function(n,t){return Math.abs(n[1]-t[1])<r?n[0]-t[0]:n[1]-t[1]})),o=[];o.push(e[0]);var u=0,c=0,a=function(){c+=1;var n=o.length-1,t=e.filter((function(t){return!(Math.abs(t[0]-o[n][0])<r&&Math.abs(t[1]-o[n][1])<r)})).map((function(t){for(var r=Math.atan2(o[n][1]-t[1],o[n][0]-t[0]);r<u;)r+=2*Math.PI;return{node:t,angle:r,distance:void 0}})).sort((function(n,t){return n.angle<t.angle?-1:n.angle>t.angle?1:0}));if(0===t.length)return{v:void 0};var i=t[0];if(t=t.filter((function(n){return Math.abs(i.angle-n.angle)<r})).map((function(t){var r=Math.sqrt(Math.pow(o[n][0]-t.node[0],2)+Math.pow(o[n][1]-t.node[1],2));return t.distance=r,t})).sort((function(n,t){return n.distance<t.distance?1:n.distance>t.distance?-1:0})),o.filter((function(n){return n===t[0].node})).length>0)return{v:o};o.push(t[0].node),u=Math.atan2(o[n][1]-t[0].node[1],o[n][0]-t[0].node[0])};do{var f=a();if("object"===n(f))return f.v}while(c<i)},At=function n(t,r,i){var e=t.map((function(n,t){return{vector:i[t],origin:n}})).map((function(n,t,r){return pt(n.vector,n.origin,r[(t+1)%r.length].vector,r[(t+1)%r.length].origin,z,z)})),o=r.map((function(n,t){return Yn(n.vector,n.origin,e[t],(function(n){return n}))}));if(3===t.length)return t.map((function(n){return{type:"skeleton",points:[n,e[0]]}})).concat([{type:"perpendicular",points:[o[0],e[0]]}]);var u=e.map((function(n,t){return un(n,o[t])})),c=0;u.forEach((function(n,t){n<u[c]&&(c=t)}));var a=[{type:"skeleton",points:[t[c],e[c]]},{type:"skeleton",points:[t[(c+1)%t.length],e[c]]},{type:"perpendicular",points:[o[c],e[c]]}],f=rt(an(r[(c+r.length-1)%r.length].vector),r[(c+1)%r.length].vector),s=c===t.length-1;return t.splice(c,2,e[c]),r.splice(c,1),i.splice(c,2,f),s&&(t.splice(0,1),i.splice(0,1),r.push(r.shift())),a.concat(n(t,r,i))},wt=function(n){var t=n.map((function(n,t,r){return[n,r[(t+1)%r.length]]})).map((function(n){return{vector:K(n[1],n[0]),origin:n[0]}})),i=n.map((function(n,t,r){return[(t-1+r.length)%r.length,t,(t+1)%r.length].map((function(n){return r[n]}))})).map((function(n){return[K(n[0],n[1]),K(n[2],n[1])]})).map((function(n){return rt.apply(void 0,r(n))}));return At(r(n),t,i)},jt=Object.freeze({__proto__:null,circumcircle:vt,signedArea:gt,centroid:dt,boundingBox:yt,makePolygonCircumradius:bt,makePolygonCircumradiusSide:xt,makePolygonInradius:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return bt(n,t/Math.cos(Math.PI/n))},makePolygonInradiusSide:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return xt(n,t/Math.cos(Math.PI/n))},makePolygonSideLength:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return bt(n,t/2/Math.sin(Math.PI/n))},makePolygonSideLengthSide:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return xt(n,t/2/Math.sin(Math.PI/n))},makePolygonNonCollinear:function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v,r=n.map((function(n,t,r){return[n,r[(t+1)%r.length]]})).map((function(n){return K(n[1],n[0])})),i=r.map((function(n,t,r){return[n,r[(t+r.length-1)%r.length]]})).map((function(n){return!hn(n[1],n[0],t)}));return n.filter((function(n,t){return i[t]}))},pleat:function(n,t,i){var e=qn(t),o=qn(i);return hn(e.vector,o.vector)?function(n,t,i){var e=Array.from(Array(n-1)).map((function(t,r){return(r+1)/n})).map((function(n){return rn(t.origin,i.origin,n)})),o=r(t.vector);return e.map((function(n){return{origin:n,vector:o}}))}(n,e,o):function(n,t,r){var i=pt(t.vector,t.origin,r.vector,r.origin);return(nt(t.vector,r.vector)<tt(t.vector,r.vector)?ut(n,t.vector,r.vector):ct(n,t.vector,r.vector)).map((function(n){return{origin:i,vector:n}}))}(n,e,o)},splitConvexPolygon:_t,convexHull:Pt,straightSkeleton:wt}),Ot=function(n){var t=n.vector,r=n.origin,i=Z(t),e=fn(t),o=Q(r,e)/i;return{normal:Y(e,1/i),distance:o}},kt=function(n){var t=n.normal,r=n.distance;return{vector:sn(t),origin:Y(t,r)}},St=Object.freeze({__proto__:null,makeNormalDistanceLine:Ot,makeVectorOriginLine:kt}),It=function(n){return n>=1?0:n<=-1?Math.PI:Math.acos(n)},Ct=function(n,t,r){var i=t[0]-n[0],e=t[1]-n[1],o=i*Math.cos(r)+e*Math.sin(r),u=e*Math.cos(r)-i*Math.sin(r);return[n[0]+o,n[1]+u]},zt=function(n,t,r,i){var e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:v,o=n<r?n:r,u=n<r?r:n,c=n<r?t:i,a=n<r?i:t,f=[c[0]-a[0],c[1]-a[1]],s=Math.sqrt(Math.pow(f[0],2)+Math.pow(f[1],2));if(!(s<e)){var l=f.map((function(n,t){return n/s*u+a[t]}));if(Math.abs(u+o-s)<e||Math.abs(u-(o+s))<e)return[l];if(!(s+o<u||u+o<s)){var h=It((o*o-s*s-u*u)/(-2*s*u)),p=Ct(a,l,+h),g=Ct(a,l,-h);return[p,g]}}},Lt=function(n,t,r,i){var e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:S,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:v,u=Math.pow(r[0],2)+Math.pow(r[1],2),c=Math.sqrt(u),a=0===c?r:r.map((function(n){return n/c})),f=fn(a),s=K(i,t),l=en(s,a);if(!(Math.abs(l)>n+o)){var h=Math.sqrt(Math.pow(n,2)-Math.pow(l,2)),p=function(n,r){return t[r]-f[r]*l+a[r]*n},g=Math.abs(n-Math.abs(l))<o?[h].map((function(n){return[n,n].map(p)})):[-h,h].map((function(n){return[n,n].map(p)})),d=g.map((function(n){return n.map((function(n,t){return n-i[t]}))})).map((function(n){return n[0]*r[0]+r[1]*n[1]})).map((function(n){return n/u}));return g.filter((function(n,t){return e(d[t],o)}))}},Et=function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:k,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:v;return n.map((function(n,t,r){return[n,r[(t+1)%r.length]]})).map((function(n){return en(X(K(n[1],n[0])),K(t,n[0]))})).map((function(n){return r(n,i)})).map((function(n,t,r){return n===r[0]})).reduce((function(n,t){return n&&t}),!0)},qt=function(n){for(var t=1;t<n.length;t+=1)if(!j(n[0],n[t]))return[n[0],n[t]]},Rt=function(n,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:L,e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:S,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:v,u=n.map((function(n,t,r){return[n,r[(t+1)%r.length]]})).map((function(n){return pt(K(n[1],n[0]),n[0],t,r,i,e,o)})).filter((function(n){return void 0!==n}));switch(u.length){case 0:return;case 1:return[u];default:return qt(u)||[u[0]]}},Nt=function(n,t,i){var e,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:L,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:I,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:v,a=Rt(n,t,i,o,u,c);switch(u){case z:e=C;break;case E:e=L;break;default:return a}var f=Rt(n,t,i,L,e,c);if(void 0!==f){var s=qt(f);if(void 0===s)switch(u){case I:return;case z:return Et(n,i,k,c)?f:void 0;case E:return Et(n,W(i,t),k,c)||Et(n,i,k,c)?f:void 0}return Et(n,nn.apply(void 0,r(s)),k,c)?s:a}},Gt={polygon:function(n){return[n]},rect:function(n){return[n]},circle:function(n){return[n.radius,n.origin]},line:function(n){return[n.vector,n.origin]},ray:function(n){return[n.vector,n.origin]},segment:function(n){return[n.vector,n.origin]}},Tt={polygon:{line:function(n,t,i,e,o){return Nt.apply(void 0,r(n).concat(r(t),[L,e,o]))},ray:function(n,t,i,e,o){return Nt.apply(void 0,r(n).concat(r(t),[L,e,o]))},segment:function(n,t,i,e,o){return Nt.apply(void 0,r(n).concat(r(t),[L,e,o]))}},circle:{circle:function(n,t,i,e,o){return zt.apply(void 0,r(n).concat(r(t),[o]))},line:function(n,t,i,e,o){return Lt.apply(void 0,r(n).concat(r(t),[e,o]))},ray:function(n,t,i,e,o){return Lt.apply(void 0,r(n).concat(r(t),[e,o]))},segment:function(n,t,i,e,o){return Lt.apply(void 0,r(n).concat(r(t),[e,o]))}},line:{polygon:function(n,t,i,e,o){return Nt.apply(void 0,r(t).concat(r(n),[L,i,o]))},circle:function(n,t,i,e,o){return Lt.apply(void 0,r(t).concat(r(n),[i,o]))},line:function(n,t,i,e,o){return pt.apply(void 0,r(n).concat(r(t),[i,e,o]))},ray:function(n,t,i,e,o){return pt.apply(void 0,r(n).concat(r(t),[i,e,o]))},segment:function(n,t,i,e,o){return pt.apply(void 0,r(n).concat(r(t),[i,e,o]))}},ray:{polygon:function(n,t,i,e,o){return Nt.apply(void 0,r(t).concat(r(n),[L,i,o]))},circle:function(n,t,i,e,o){return Lt.apply(void 0,r(t).concat(r(n),[i,o]))},line:function(n,t,i,e,o){return pt.apply(void 0,r(t).concat(r(n),[e,i,o]))},ray:function(n,t,i,e,o){return pt.apply(void 0,r(n).concat(r(t),[i,e,o]))},segment:function(n,t,i,e,o){return pt.apply(void 0,r(n).concat(r(t),[i,e,o]))}},segment:{polygon:function(n,t,i,e,o){return Nt.apply(void 0,r(t).concat(r(n),[L,i,o]))},circle:function(n,t,i,e,o){return Lt.apply(void 0,r(t).concat(r(n),[i,o]))},line:function(n,t,i,e,o){return pt.apply(void 0,r(t).concat(r(n),[e,i,o]))},ray:function(n,t,i,e,o){return pt.apply(void 0,r(t).concat(r(n),[e,i,o]))},segment:function(n,t,i,e,o){return pt.apply(void 0,r(n).concat(r(t),[i,e,o]))}}},Vt={polygon:"polygon",rect:"polygon",circle:"circle",line:"line",ray:"ray",segment:"segment"},Bt={polygon:k,rect:k,circle:k,line:I,ray:z,segment:E},Ft=function(n,t,r){var i=o(n),e=o(t),u=Vt[i],c=Vt[e],a=Gt[i](n),f=Gt[e](t),s=n.domain_function||Bt[i],l=t.domain_function||Bt[e];return Tt[u][c](a,f,s,l,r)},Dt=function(t,r){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v,e=0;e<2;e++)for(var o=0===e?t:r,u=0===e?r:t,c=function(n){var t=o[n],r=fn(K(o[(n+1)%o.length],o[n])),e=u.map((function(n){return K(n,t)})).map((function(n){return Q(r,n)})),c=o[(n+2)%o.length],a=Q(r,K(c,t))>0;if(e.map((function(n){return a?n<i:n>-i})).reduce((function(n,t){return n&&t}),!0))return{v:!1}},a=0;a<o.length;a++){var f=c(a);if("object"===n(f))return f.v}return!0},Zt=function(n,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k,e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:v;return i(n-cn(t,r),e)},Ut=function(n,t,r,i){var e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:I,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:I,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:v,c=en(n,r),a=-c,f=[i[0]-t[0],i[1]-t[1]];if(Math.abs(c)<u){if(Math.abs(en(f,n))>u)return!1;var s=f,l=W(s,r),h=Q(n,n),p=Q(s,n)/h,g=Q(l,n)/h,d=p<g?p:g,y=p<g?g:p,m=d>1-u,M=y<u;return!m&&!M}var b=[-f[0],-f[1]],x=en(f,r)/c,_=en(b,n)/a;return e(x,u/Z(n))&&o(_,u/Z(r))},Ht={polygon:function(n){return[n]},rect:function(n){return[n]},circle:function(n){return[n.radius,n.origin]},line:function(n){return[n.vector,n.origin]},ray:function(n){return[n.vector,n.origin]},segment:function(n){return[n.vector,n.origin]},vector:function(n){return[n]}},Xt={polygon:{polygon:function(n,t,i,e,o){return Dt.apply(void 0,r(n).concat(r(t),[o]))},vector:function(n,t,i,e,o){return Et.apply(void 0,r(n).concat(r(t),[i,o]))}},circle:{vector:function(n,t,i,e,o){return Zt.apply(void 0,r(n).concat(r(t),[k,o]))}},line:{line:function(n,t,i,e,o){return Ut.apply(void 0,r(n).concat(r(t),[i,e,o]))},ray:function(n,t,i,e,o){return Ut.apply(void 0,r(n).concat(r(t),[i,e,o]))},segment:function(n,t,i,e,o){return Ut.apply(void 0,r(n).concat(r(t),[i,e,o]))},vector:function(n,t,i,e,o){return ht.apply(void 0,r(n).concat(r(t),[i,o]))}},ray:{line:function(n,t,i,e,o){return Ut.apply(void 0,r(t).concat(r(n),[e,i,o]))},ray:function(n,t,i,e,o){return Ut.apply(void 0,r(n).concat(r(t),[i,e,o]))},segment:function(n,t,i,e,o){return Ut.apply(void 0,r(n).concat(r(t),[i,e,o]))},vector:function(n,t,i,e,o){return ht.apply(void 0,r(n).concat(r(t),[i,o]))}},segment:{line:function(n,t,i,e,o){return Ut.apply(void 0,r(t).concat(r(n),[e,i,o]))},ray:function(n,t,i,e,o){return Ut.apply(void 0,r(t).concat(r(n),[e,i,o]))},segment:function(n,t,i,e,o){return Ut.apply(void 0,r(n).concat(r(t),[i,e,o]))},vector:function(n,t,i,e,o){return ht.apply(void 0,r(n).concat(r(t),[i,o]))}},vector:{polygon:function(n,t,i,e,o){return Et.apply(void 0,r(t).concat(r(n),[e,o]))},circle:function(n,t,i,e,o){return Zt.apply(void 0,r(t).concat(r(n),[k,o]))},line:function(n,t,i,e,o){return ht.apply(void 0,r(t).concat(r(n),[e,o]))},ray:function(n,t,i,e,o){return ht.apply(void 0,r(t).concat(r(n),[e,o]))},segment:function(n,t,i,e,o){return ht.apply(void 0,r(t).concat(r(n),[e,o]))},vector:function(n,t,i,e,o){return j.apply(void 0,r(n).concat(r(t),[o]))}}},Yt={polygon:"polygon",rect:"polygon",circle:"circle",line:"line",ray:"ray",segment:"segment",vector:"vector"},$t={polygon:k,rect:k,circle:k,line:I,ray:z,segment:E,vector:I},Wt=function(n,t,r){var i=o(n),e=o(t),u=Yt[i],c=Yt[e],a=Ht[i](n),f=Ht[e](t),s=n.domain_function||$t[i],l=t.domain_function||$t[e];return Xt[u][c](a,f,s,l,r)},Jt=function(n,t,r){return W(t,Y(n,r))},Kt=function(n,t,r,i,e){return n.map((function(n,t,r){return[K(r[(t+1)%r.length],n),n]})).map((function(n){return function(n,t,r,i){var e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:L,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:v,u=en(X(n),X(r));if(!(Math.abs(u)<o)){var c=en(n,r),a=-c,f=K(i,t),s=an(f),l=en(f,r)/c;return e(en(s,n)/a,o/Z(r))?l:void 0}}(t,r,n[0],n[1],i,e)})).filter(_).sort((function(n,t){return n-t}))},Qt=function(n,t,r){for(var i=0,e=n.length-1;i<e&&!t(n[i+1]-n[i],r);)i++;for(;e>i&&!t(n[e]-n[e-1],r);)e--;if(!(i>=e))return[n[i],n[e]]},nr=function(n,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:O,e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:S,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:v,u=Kt(n,t,r,L,o);if(!(u.length<2)){var c=2*o/Z(t),a=Qt(u,i,c);if(void 0!==a){var f=a.map((function(n,t){return e(n)?n:n<.5?0:1}));if(!(Math.abs(f[0]-f[1])<2*o/Z(t))){var s=Jt(t,r,(f[0]+f[1])/2);return Et(n,s,i,o)?f.map((function(n){return Jt(t,r,n)})):void 0}}}},tr={preserve:{magnitude:function(){return Z(this)},isEquivalent:function(){return j(this,zn(arguments))},isParallel:function(){return hn.apply(void 0,r(c(this,zn(arguments))))},isCollinear:function(n){return Wt(this,n)},dot:function(){return Q.apply(void 0,r(c(this,zn(arguments))))},distanceTo:function(){return un.apply(void 0,r(c(this,zn(arguments))))},overlap:function(n){return Wt(this,n)}},vector:{copy:function(){return r(this)},normalize:function(){return X(this)},scale:function(){return Y(this,arguments[0])},flip:function(){return an(this)},rotate90:function(){return fn(this)},rotate270:function(){return sn(this)},cross:function(){return on(u(3,this),u(3,zn(arguments)))},transform:function(){return yn(Dn(arguments),u(3,this))},add:function(){return W(this,u(this.length,zn(arguments)))},subtract:function(){return K(this,u(this.length,zn(arguments)))},rotateZ:function(n,t){return yn(Dn(F(n,t)),u(3,this))},lerp:function(n,t){return rn(this,u(this.length,zn(n)),t)},midpoint:function(){return nn.apply(void 0,r(c(this,zn(arguments))))},bisect:function(){return it(this,zn(arguments))}}},rr={};Object.keys(tr.preserve).forEach((function(n){rr[n]=tr.preserve[n]})),Object.keys(tr.vector).forEach((function(n){rr[n]=function(){return G.vector.apply(G,r(tr.vector[n].apply(this,arguments)))}}));var ir={fromAngle:function(n){return G.vector(Math.cos(n),Math.sin(n))},fromAngleDegrees:function(n){return G.vector.fromAngle(n*d)}},er={vector:{P:Array.prototype,A:function(){this.push.apply(this,r(zn(arguments)))},G:{x:function(){return this[0]},y:function(){return this[1]},z:function(){return this[2]}},M:rr,S:ir}},or={fromPoints:function(){var n=Ln(arguments);return this.constructor({vector:K(n[1],n[0]),origin:n[0]})},fromAngle:function(){var n=arguments[0]||0;return this.constructor({vector:[Math.cos(n),Math.sin(n)],origin:[0,0]})},perpendicularBisector:function(){var n=Ln(arguments);return this.constructor({vector:fn(K(n[1],n[0])),origin:tn(n[0],n[1])})}},ur={isParallel:function(){var n=c(this.vector,qn(arguments).vector);return hn.apply(void 0,r(n))},isCollinear:function(){var n=qn(arguments);return ht(this.vector,this.origin,n.origin)&&hn.apply(void 0,r(c(this.vector,n.vector)))},isDegenerate:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v;return ln(this.vector,n)},reflectionMatrix:function(){return G.matrix(Sn(this.vector,this.origin))},nearestPoint:function(){var n=zn(arguments);return G.vector(Yn(this.vector,this.origin,n,this.clip_function))},transform:function(){var n=this.dimension,t=mn(Dn(arguments),u(3,this.vector),u(3,this.origin));return this.constructor(u(n,t.vector),u(n,t.origin))},translate:function(){var n=W.apply(void 0,r(c(this.origin,zn(arguments))));return this.constructor(this.vector,n)},intersect:function(){return Ft.apply(void 0,[this].concat(Array.prototype.slice.call(arguments)))},overlap:function(){return Wt.apply(void 0,[this].concat(Array.prototype.slice.call(arguments)))},bisect:function(n,t){var r=this,i=qn(n);return at(this.vector,this.origin,i.vector,i.origin,t).map((function(n){return r.constructor(n)}))}},cr={line:{P:Object.prototype,A:function(){var n=qn.apply(void 0,arguments);this.vector=G.vector(n.vector),this.origin=G.vector(u(this.vector.length,n.origin));var t=Ot({vector:this.vector,origin:this.origin});this.normal=t.normal,this.distance=t.distance,Object.defineProperty(this,"domain_function",{writable:!0,value:S})},G:{dimension:function(){return[this.vector,this.origin].map((function(n){return n.length})).reduce((function(n,t){return Math.max(n,t)}),0)}},M:Object.assign({},ur,{inclusive:function(){return this.domain_function=S,this},exclusive:function(){return this.domain_function=I,this},clip_function:function(n){return n},svgPath:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e4,t=W(this.origin,Y(this.vector,-n/2)),r=Y(this.vector,n);return"M".concat(t[0]," ").concat(t[1],"l").concat(r[0]," ").concat(r[1])}}),S:Object.assign({fromNormalDistance:function(){return this.constructor(kt(arguments[0]))}},or)}},ar={ray:{P:Object.prototype,A:function(){var n=qn.apply(void 0,arguments);this.vector=G.vector(n.vector),this.origin=G.vector(u(this.vector.length,n.origin)),Object.defineProperty(this,"domain_function",{writable:!0,value:C})},G:{dimension:function(){return[this.vector,this.origin].map((function(n){return n.length})).reduce((function(n,t){return Math.max(n,t)}),0)}},M:Object.assign({},ur,{inclusive:function(){return this.domain_function=C,this},exclusive:function(){return this.domain_function=z,this},flip:function(){return G.ray(an(this.vector),this.origin)},scale:function(n){return G.ray(this.vector.scale(n),this.origin)},normalize:function(){return G.ray(this.vector.normalize(),this.origin)},clip_function:q,svgPath:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4,t=this.vector.scale(n);return"M".concat(this.origin[0]," ").concat(this.origin[1],"l").concat(t[0]," ").concat(t[1])}}),S:or}},fr={segment:{P:Array.prototype,A:function(){var n=En.apply(void 0,arguments);this.push.apply(this,r([n[0],n[1]].map((function(n){return G.vector(n)})))),this.vector=G.vector(K(this[1],this[0])),this.origin=this[0],Object.defineProperty(this,"domain_function",{writable:!0,value:L})},G:{points:function(){return this},magnitude:function(){return Z(this.vector)},dimension:function(){return[this.vector,this.origin].map((function(n){return n.length})).reduce((function(n,t){return Math.max(n,t)}),0)}},M:Object.assign({},ur,{inclusive:function(){return this.domain_function=L,this},exclusive:function(){return this.domain_function=E,this},clip_function:R,transform:function(){for(var n=this.points[0].length,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var e=Dn(r),o=this.points.map((function(n){return u(3,n)})).map((function(n){return yn(e,n)})).map((function(t){return u(n,t)}));return G.segment(o)},translate:function(){var n=zn(arguments),t=this.points.map((function(t){return W.apply(void 0,r(c(t,n)))}));return G.segment(t)},midpoint:function(){return G.vector(tn(this.points[0],this.points[1]))},svgPath:function(){var n=this.points.map((function(n){return"".concat(n[0]," ").concat(n[1])}));return["M","L"].map((function(t,r){return"".concat(t).concat(n[r])})).join("")}}),S:{fromPoints:function(){return this.constructor.apply(this,arguments)}}}},sr=function(n,t,r,i,e,o){var u=Math.cos(e),c=Math.sin(e),a=Math.cos(o),f=Math.sin(o);return[n+u*r*a+-c*i*f,t+c*r*a+u*i*f]},lr=function(n,t,r,i,e,o,u){var c=o;if(c<0&&!isNaN(c))for(;c<0;)c+=2*Math.PI;var a=u>2*Math.PI?2*Math.PI:u,f=sr(n,t,r,i,e,c),s=sr(n,t,r,i,e,c+a/2),l=sr(n,t,r,i,e,c+a),h=a/2>Math.PI?1:0,p=a/2>0?1:0;return{x1:f[0],y1:f[1],x2:s[0],y2:s[1],x3:l[0],y3:l[1],fa:h,fs:p}},hr=function(n){return f(n,4)},pr=function(n,t,r,i,e,o,u){return"A".concat(hr(n)," ").concat(hr(t)," ").concat(hr(r)," ").concat(hr(i)," ").concat(hr(e)," ").concat(hr(o)," ").concat(hr(u))},vr={circle:{A:function(){var n=Vn.apply(void 0,arguments);this.radius=n.radius,this.origin=G.vector.apply(G,r(n.origin))},G:{x:function(){return this.origin[0]},y:function(){return this.origin[1]},z:function(){return this.origin[2]}},M:{nearestPoint:function(){return G.vector(Wn(this.radius,this.origin,zn(arguments)))},intersect:function(n){return Ft(this,n)},overlap:function(n){return Wt(this,n)},svgPath:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2*Math.PI,r=lr(this.origin[0],this.origin[1],this.radius,this.radius,0,n,t),i=pr(this.radius,this.radius,0,r.fa,r.fs,r.x2,r.y2),e=pr(this.radius,this.radius,0,r.fa,r.fs,r.x3,r.y3);return"M".concat(r.x1," ").concat(r.y1).concat(i).concat(e)},points:function(){var n=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;return Array.from(Array(t)).map((function(n,r){return 2*Math.PI/t*r})).map((function(t){return[n.origin[0]+n.radius*Math.cos(t),n.origin[1]+n.radius*Math.sin(t)]}))},polygon:function(){return G.polygon(this.points(arguments[0]))},segments:function(){var n=this.points(arguments[0]);return n.map((function(t,r){var i=(r+1)%n.length;return[t,n[i]]}))}},S:{fromPoints:function(){if(3===arguments.length){var n=vt.apply(void 0,arguments);return this.constructor(n.radius,n.origin)}return this.constructor.apply(this,arguments)},fromThreePoints:function(){var n=vt.apply(void 0,arguments);return this.constructor(n.radius,n.origin)}}}},gr=function(n,t,r,i){var e=t>r,o=e?Math.pow(t,2)-Math.pow(r,2):Math.pow(r,2)-Math.pow(t,2),u=Math.sqrt(o),c=e?Math.cos(i):Math.sin(i),a=e?Math.sin(i):Math.cos(i);return[G.vector(n[0]+u*c,n[1]+u*a),G.vector(n[0]-u*c,n[1]-u*a)]},dr={ellipse:{A:function(){var n=h(arguments).filter((function(n){return!isNaN(n)})),t=u(5,n);this.rx=t[0],this.ry=t[1],this.origin=G.vector(t[2],t[3]),this.spin=t[4],this.foci=gr(this.origin,this.rx,this.ry,this.spin)},G:{x:function(){return this.origin[0]},y:function(){return this.origin[1]}},M:{svgPath:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2*Math.PI,r=lr(this.origin[0],this.origin[1],this.rx,this.ry,this.spin,n,t),i=pr(this.rx,this.ry,this.spin/Math.PI*180,r.fa,r.fs,r.x2,r.y2),e=pr(this.rx,this.ry,this.spin/Math.PI*180,r.fa,r.fs,r.x3,r.y3);return"M".concat(r.x1," ").concat(r.y1).concat(i).concat(e)},points:function(){var n=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;return Array.from(Array(t)).map((function(n,r){return 2*Math.PI/t*r})).map((function(t){return sr(n.origin.x,n.origin.y,n.rx,n.ry,n.spin,t)}))},polygon:function(){return G.polygon(this.points(arguments[0]))},segments:function(){var n=this.points(arguments[0]);return n.map((function(t,r){var i=(r+1)%n.length;return[t,n[i]]}))}},S:{}}},yr={area:function(){return gt(this)},centroid:function(){return G.vector(dt(this))},boundingBox:function(){return yt(this)},straightSkeleton:function(){return wt(this)},scale:function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:dt(this),r=this.map((function(n){return[0,1].map((function(r,i){return n[i]-t[i]}))})).map((function(r){return r.map((function(i,e){return t[e]+r[e]*n}))}));return this.constructor.fromPoints(r)},rotate:function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:dt(this),r=this.map((function(r){var i=[r[0]-t[0],r[1]-t[1]],e=Math.sqrt(Math.pow(i[0],2)+Math.pow(i[1],2)),o=Math.atan2(i[1],i[0]);return[t[0]+Math.cos(o+n)*e,t[1]+Math.sin(o+n)*e]}));return G.polygon(r)},translate:function(){var n=zn.apply(void 0,arguments),t=this.map((function(t){return t.map((function(t,r){return t+n[r]}))}));return this.constructor.fromPoints(t)},transform:function(){var n=Dn.apply(void 0,arguments),t=this.map((function(t){return yn(n,u(3,t))}));return G.polygon(t)},nearest:function(){var n=zn.apply(void 0,arguments),t=$n(this,n);return void 0===t?void 0:Object.assign(t,{edge:this.sides[t.i]})},split:function(){var n=qn.apply(void 0,arguments),t=_t;return t(this,n.vector,n.origin).map((function(n){return G.polygon(n)}))},overlap:function(){return Wt.apply(void 0,[this].concat(Array.prototype.slice.call(arguments)))},intersect:function(){return Ft.apply(void 0,[this].concat(Array.prototype.slice.call(arguments)))},clip:function(n,t){var r=n.domain_function?n.domain_function:S,i=nr(this,n.vector,n.origin,this.domain_function,r,t);return i?G.segment(i):void 0},svgPath:function(){var n=Array(this.length).fill("L");return n[0]="M","".concat(this.map((function(t,r){return"".concat(n[r]).concat(t[0]," ").concat(t[1])})).join(""),"z")}},mr=function(n){return[[n.x,n.y],[n.x+n.width,n.y],[n.x+n.width,n.y+n.height],[n.x,n.y+n.height]]},Mr={rect:{P:Array.prototype,A:function(){var n=Gn.apply(void 0,arguments);this.width=n.width,this.height=n.height,this.origin=G.vector(n.x,n.y),this.push.apply(this,r(mr(this))),Object.defineProperty(this,"domain_function",{writable:!0,value:O})},G:{x:function(){return this.origin[0]},y:function(){return this.origin[1]},center:function(){return G.vector(this.origin[0]+this.width/2,this.origin[1]+this.height/2)}},M:Object.assign({},yr,{inclusive:function(){return this.domain_function=O,this},exclusive:function(){return this.domain_function=k,this},area:function(){return this.width*this.height},segments:function(){return[[[(n=this).x,n.y],[n.x+n.width,n.y]],[[n.x+n.width,n.y],[n.x+n.width,n.y+n.height]],[[n.x+n.width,n.y+n.height],[n.x,n.y+n.height]],[[n.x,n.y+n.height],[n.x,n.y]]];var n},svgPath:function(){return"M".concat(this.origin.join(" "),"h").concat(this.width,"v").concat(this.height,"h").concat(-this.width,"Z")}}),S:{fromPoints:function(){var n=yt(Ln(arguments));return G.rect(n.min[0],n.min[1],n.span[0],n.span[1])}}}},br={polygon:{P:Array.prototype,A:function(){this.push.apply(this,r(l(arguments))),this.sides=this.map((function(n,t,r){return[n,r[(t+1)%r.length]]})),this.vectors=this.sides.map((function(n){return K(n[1],n[0])})),Object.defineProperty(this,"domain_function",{writable:!0,value:O})},G:{isConvex:function(){},points:function(){return this}},M:Object.assign({},yr,{inclusive:function(){return this.domain_function=O,this},exclusive:function(){return this.domain_function=k,this},segments:function(){return this.sides}}),S:{fromPoints:function(){return this.constructor.apply(this,arguments)},regularPolygon:function(){return this.constructor(bt.apply(void 0,arguments))},convexHull:function(){return this.constructor(Pt.apply(void 0,arguments))}}}},xr={polyline:{P:Array.prototype,A:function(){this.push.apply(this,r(l(arguments)))},G:{points:function(){return this}},M:{svgPath:function(){var n=Array(this.length).fill("L");return n[0]="M","".concat(this.map((function(t,r){return"".concat(n[r]).concat(t[0]," ").concat(t[1])})).join(""))}},S:{fromPoints:function(){return this.constructor.apply(this,arguments)}}}},_r=function(n,t){for(var r=0;r<12;r+=1)n[r]=t[r];return n},Pr={matrix:{P:Array.prototype,A:function(){var n=this;Dn(arguments).forEach((function(t){return n.push(t)}))},G:{},M:{copy:function(){return G.matrix.apply(G,r(Array.from(this)))},set:function(){return _r(this,Dn(arguments))},isIdentity:function(){return dn(this)},multiply:function(n){return _r(this,Mn(this,n))},determinant:function(){return bn(this)},inverse:function(){return _r(this,xn(this))},translate:function(n,t,r){return _r(this,Mn(this,_n(n,t,r)))},rotateX:function(n){return _r(this,Mn(this,An(n)))},rotateY:function(n){return _r(this,Mn(this,wn(n)))},rotateZ:function(n){return _r(this,Mn(this,jn(n)))},rotate:function(n,t,r){var i=On(n,t,r);return _r(this,Mn(this,i))},scale:function(n){return _r(this,Mn(this,kn(n)))},reflectZ:function(n,t){var r=Sn(n,t);return _r(this,Mn(this,r))},transform:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return G.vector(yn(this,u(3,zn(t))))},transformVector:function(n){return G.vector(yn(this,u(3,zn(n))))},transformLine:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];var i=qn(t);return G.line(mn(this,i.vector,i.origin))}},S:{}}},Ar=Object.assign({},er,cr,ar,fr,vr,dr,Mr,br,xr,Pr),wr=function(n,t){var r=Object.create(Ar[n].proto);return Ar[n].A.apply(r,t),r};Object.assign(G,{vector:function(){return wr("vector",arguments)},line:function(){return wr("line",arguments)},ray:function(){return wr("ray",arguments)},segment:function(){return wr("segment",arguments)},circle:function(){return wr("circle",arguments)},ellipse:function(){return wr("ellipse",arguments)},rect:function(){return wr("rect",arguments)},polygon:function(){return wr("polygon",arguments)},polyline:function(){return wr("polyline",arguments)},matrix:function(){return wr("matrix",arguments)}}),Object.keys(Ar).forEach((function(n){var t={};t.prototype=null!=Ar[n].P?Object.create(Ar[n].P):Object.create(Object.prototype),t.prototype.constructor=t,G[n].prototype=t.prototype,G[n].prototype.constructor=G[n],Object.keys(Ar[n].G).forEach((function(r){return Object.defineProperty(t.prototype,r,{get:Ar[n].G[r]})})),Object.keys(Ar[n].M).forEach((function(r){return Object.defineProperty(t.prototype,r,{value:Ar[n].M[r]})})),Object.keys(Ar[n].S).forEach((function(t){return Object.defineProperty(G[n],t,{value:Ar[n].S[t].bind(G[n].prototype)})})),Ar[n].proto=t.prototype}));var jr=G;return jr.core=Object.assign(Object.create(null),m,p,Zn,N,pn,Un,Hn,jt,lt,D,In,Jn,St,{enclosingPolygonPolygon:function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:O,i=n.map((function(n){return Et(t,n,r)})).reduce((function(n,t){return n||t}),!1),e=t.map((function(n){return Et(t,n,r)})).reduce((function(n,t){return n&&t}),!0);return!i&&e},intersectConvexPolygonLine:Nt,intersectCircleCircle:zt,intersectCircleLine:Lt,intersectLineLine:pt,overlapConvexPolygons:Dt,overlapConvexPolygonPoint:Et,overlapBoundingBoxes:function(n,t){for(var r=n.min.length>t.min.length?t.min.length:n.min.length,i=0;i<r;i++)if(n.min[i]>t.max[i]||n.max[i]<t.min[i])return!1;return!0},overlapLineLine:Ut,overlapLinePoint:ht,clipLineConvexPolygon:nr,clipPolygonPolygon:function(n,t){var r,i,e,o,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v,c=function(n){return(i[0]-r[0])*(n[1]-r[1])>(i[1]-r[1])*(n[0]-r[0])+u},a=function(){var n=[r[0]-i[0],r[1]-i[1]],t=[e[0]-o[0],e[1]-o[1]],u=r[0]*i[1]-r[1]*i[0],c=e[0]*o[1]-e[1]*o[0],a=1/(n[0]*t[1]-n[1]*t[0]);return[(u*t[0]-c*n[0])*a,(u*t[1]-c*n[1])*a]},f=n;for(var s in r=t[t.length-1],t){i=t[s];var l=f;for(var h in f=[],e=l[l.length-1],l)c(o=l[h])?(c(e)||f.push(a()),f.push(o)):c(e)&&f.push(a()),e=o;r=i}return 0===f.length?void 0:f}}),jr.typeof=o,jr.intersect=Ft,jr.overlap=Wt,jr}));
